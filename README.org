#+title: Nixos Configrations
#+email: aniketkhareldev@gmail.com
#+description: Simple working configuration for my nixos.

* Environment

#+begin_elisp options

export NIX_CONFIG="experimental-features = nix-command flakes" ```

#+end_elisp

* Partitioning

#+begin_elisp options

parted /dev/sda -- mklabel msdos (gpt for uefi)

parted /dev/sda -- mkpart primary 1MiB -8GiB (512MiB -8GiB for uefi)

mkfs.ext4 -L nixos /dev/sda1

;; mounting

sudo mount /dev/disk/by-label/nixos /mnt

# in case of gpt, flag a f32 partition with esp,boot

sudo mkdir -p /mnt/boot
sudo mount /dev/disk/by-label/BOOT /mnt/boot

#+end_elisp

* Configrations

** Hardwares

#+begin_elisp options

nixos-generate-config --root /mnt

#+end_elisp

* Installation

#+begin_elisp options

sudo nixos-rebuild switch --flake .#hostname

# or

nixos-install --flake .#hostname

#+end_elisp

** Home Manager

To apply home configrationsm run, this is with standalone installer.
If you don't have home-manager installed, try,

```sh
nix shell nixpkgs#home-manager.
```

```sh
 home-manager switch --flake .#your-username@your-hostname
```

* Packages, services, settings, etc.

** NixEnv

To install and run applications.

```sh
nix-env -iA nixos.htop
```

To list all the installed envs.

```sh
nix-env
```

```sh
nix-env -uninstall htop
```

_man configrations.nix_ for more docs.

* Post Setup

** Node

```sh
mkdir ~/nodejs_globals
npm config set prefix '~/nodejs_globals'
npm install -g instant-markdown-d
# ln -s ~/nodejs_globals/bin/ ~/bin # optional, path already in zshrc
```

* Todo

Wireless Driver not supported on vintage host. *rtl8723be*.
[[https://github.com/NixOS/nixpkgs/issues/130280][Wifi not working]]

* Reference

- [[Matthias Benaets][https://www.youtube.com/watch?v=AGVXJ-TIv3Y&t=1164s]]
